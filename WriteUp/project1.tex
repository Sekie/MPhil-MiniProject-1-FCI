%%
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%%
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%%
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%%
%% This template has been modified by Philip Blakely for
%% local distribution to students on the MPhil for Scientific
%% Computing course run at the University of Cambridge.
%%

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01
%%
%%
%%
%% $Id: elsarticle-template-num.tex 4 2009-10-24 08:22:58Z rishi $
%%
%%
\documentclass[final,3p,times,twocolumn]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% if you use PostScript figures in your article
%% use the graphics package for simple commands
%% \usepackage{graphics}
%% or use the graphicx package for more complicated commands
%% \usepackage{graphicx}
%% or use the epsfig package if you prefer to use the old commands
%% \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
%% The amsthm package provides extended theorem environments
%% \usepackage{amsthm}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers after \end{frontmatter}.
%% \usepackage{lineno}

%% natbib.sty is loaded by default. However, natbib options can be
%% provided with \biboptions{...} command. Following options are
%% valid:

%%   round  -  round parentheses are used (default)
%%   square -  square brackets are used   [option]
%%   curly  -  curly braces are used      {option}
%%   angle  -  angle brackets are used    <option>
%%   semicolon  -  multiple citations separated by semi-colon
%%   colon  - same as semicolon, an earlier confusion
%%   comma  -  separated by comma
%%   numbers-  selects numerical citations
%%   super  -  numerical citations as superscripts
%%   sort   -  sorts multiple citations according to order in ref. list
%%   sort&compress   -  like sort, but also compresses numerical citations
%%   compress - compresses without sorting
%%
\biboptions{super}

% \biboptions{}

\usepackage{physics}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{mathtools}
%\usepackage{algorithm}
\usepackage[]{algorithm2e}

\newcommand{\ai}{\textit{ab-initio}}
\newcommand{\ssth}{\textsuperscript{th}}
\newcommand{\ham}{\hat{\mathcal{H}}}


\journal{MPhil in Scientific Computing}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for the associated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for the associated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for the associated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%%
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{Full Configuration Interaction Calculations on BH and H$_2$O}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{<author name>}
%% \address[label1]{<address>}
%% \address[label2]{<address>}

\author{Henry Tran}

\address{Department of Chemistry, Lensfield Road, Cambridge, UK,
CB2 1EW}

\begin{abstract}
Tom Brady is the G.O.A.T.
\end{abstract}

\end{frontmatter}

%%
%% Start line numbering here if you want
%%
% \linenumbers

%% main text
\section{Introduction} \label{sec:intro}
The method of configuration interaction (CI) is ubiquitous in computational chemistry and has a rich and varied history.\cite{shavitt} CI builds upon the Hartree-Fock (HF) method,\cite{hartree,fock} which provides a cheap, approximate solution to the time-independent Schr\"{o}dinger Equation. Although HF is inexpensive, it approximates the true wavefunction as a single configuration and cannot account for correlation energy.\cite{szabo} Slater introduced the Slater determinant and showed how multiple configurations could be derived from the HF solution.\cite{slater} CI takes advantage of these configurations by introducing coupling between the different configurations, providing a solution that includes correlation energy. Condon further derived the rules to calculate the value of coupling between different configurations.\cite{condon} These configurations are formally a complete basis for the Hilbert Space in which the true solution lies. In practice, one uses a finite basis of either Slater determinants, or a linear combination of Slater determinants that are eigenstates of spin-angular momentum called configuration state functions (CSF). A solution using all possible n-electron determinants or CSFs from a set of one-particle functions, or atomic orbitals, is called full CI (FCI). FCI gives an exact solution to Schr\"{o}dinger's Equation in that function space, but scales exponentially with system size, making practical calculations only possible for the smallest of molecules.\cite{szabo}

Early CI calculations used a Slater-type orbital (STO) basis set introduced by Slater.\cite{sto} The high cost of numerically integrating STOs made it very difficult to conduct \ai\ calculations on polyatomic systems.\cite{shavitt} Later, Boys introduced gaussian-type orbitals (GTO) as a basis to significantly simplify integrals.\cite{gto} One prominent calculation in the early days of CI includes the calculation of the three lowest lying electronic states of CH$_2$ in 1960.\cite{boys-1960} This calculation was the first to predict a bent ground state geometry for CH$_2$.

Much work has been dedicated to improving the efficiency and speed of CI calculations. While an FCI calculation provides a more complete solution than a calculation involving fewer configurations, FCI is not always feasible. However, new algorithms and computational tools have allowed for FCI calculations on systems of unprecedented sizes.\cite{bendazzoli-1995} Among these include a vector algorithm first introduced by Knowles and Handy for FCI in a determinant basis.\cite{handy-1984,handy-1988,olsen,evangelisti-1993}

Rather than going to the FCI limit, the configurations included in the CI expansion are typically truncated based on how many electrons are occupying virtual orbitals. For example, the inclusion of single excitations is called CIS. The inclusion of double excitations is called CISD, and so on.\cite{szabo}  

Though truncated CI allows for electronic structure calculations of much larger systems, they are not size-extensive. Only in the FCI limit is CI size-extensive, and it is for this reason coupled-cluster (CC) methods have taken over CI methods in popularity for mid-sized molecules.\cite{cc,bartlett-2007} Pople and Head-Gordon later formulated quadratic CI (QCI), which modified CI to be size-extensive.\cite{qci} QCI has been shown to be comparable to CC methods.\cite{werner-1992}

CI methods can be classified as single reference CI (SRCI) or multireference CI (MRCI). In SRCI, the CI expansion is based on one configuration, typically a HF solution. For MRCI, the expansion is based on a set of configuration references.\cite{hackmeyer-1969} Early choices for the reference configurations tended to be based on physical considerations\cite{shavitt-1974} or perturbative estimates for the most important configurations to the ground state.\cite{nesbet-1955} Later, more systematic choices were adopted. One choice is to take a set of ``active'' orbitals, typically valence orbitals, and then use the FCI expansion in the active space as a reference.\cite{cas} This method is known as complete active space (CAS). In some cases, CAS provides too many references to be computationally feasible. Another approach is to put an occupancy restriction on active space orbitals, in a method called restricted active space (RAS).\cite{ras} There is active work on further restrictions,\cite{shavitt} but they will not be mentioned here.

In terms of choosing CSFs, many methods exist including symmetric group methods,\cite{wigner} projection operator methods,\cite{lowdin} and unitary group methods.\cite{paldus-1974} These methods serve to construct a basis of eigenstates of total spin-angular momentum. However, no spin adaption will be done in this paper. % Basis set? Orbitals?

The most expensive procedure in the CI algorithm is the diagonalization of the Hamiltonian matrix in the space of potentially millions of CSFs or determinants. However, in any CI calculation, one is typically only interested in a few lower lying solutions. Iterative methods such as the Lanczos algorithm are known to be effective for these situations.\cite{Lanczos} Davidson introduced a similar iterative algorithm that exploits the diagonal dominance of the Hamiltonian matrix to compute specific eigenvalues of the Hamiltonian without need to calculate lower eigenvalues first.\cite{davidson} Since then, a modified version of the Davidson algorithm was introduced by Liu to allow the algorithm to converge to multiple eigenvalues at once.\cite{liu}

This paper will discuss application of the FCI method on the BH and H$_2$O molecules, which have been previously studied using FCI.\cite{cccbdb,handy-1983} The Hamiltonian matrix will be constructed in a space of Slater determinants and the Davidson diagonalization algorithm will be implemented. 

\section{Theory}
\subsection{Electronic Problem} \label{sec:elproblem}
The molecular Hamiltonian, ignoring higher order effects such as relativistic or fine-structure terms, is
\begin{equation}
\begin{gathered}
\hat{\mathcal H} = - \sum_I \dfrac{1}{2M_I} \nabla_I^2 -\dfrac{1}{2} \sum_i \nabla_i^2 - \sum_{iI} \dfrac{Z_I}{|\mathbf{R}_I - \mathbf{r}_i|} \\
+ \sum_{i < j} \dfrac{1}{|\mathbf{r}_i - \mathbf{r}_j|} + \sum_{I < J} \dfrac{Z_IZ_J}{|\mathbf{R}_I - \mathbf{R}_J|}
\end{gathered}
\end{equation}
The terms in order are: nuclear kinetic energy, electronic kinetic energy, electron-nuclear attraction, electron-electron repulsion, and nuclear-nuclear repulsion. Lowercase indexes label electrons, uppercase indexes label nuclei, $\mathbf{r}_i$ denotes the cartesian coordinates of the $i$\ssth\ electron, $\mathbf{R}_I$ denotes the cartesian coordinates of the $I$\ssth\ nucleus, and $Z_I$ is the atomic number of the $I$\ssth\ nucleus. All the electron coordinates will be denoted $\mathbf{r}$ and all the nucleus coordinates will be denoted $\mathbf{R}$. The last four terms are typically defined as the electronic Hamiltonian, $\ham_e$.
\begin{gather}
\hat{\mathcal H} = - \sum_I \dfrac{1}{2M_I} \nabla_I^2 + \ham_e \\
\begin{gathered}\label{eq:hame}
\ham_e = \hat T_e + \hat V_{eN} + \hat V_{NN} + \hat V_{eN}
\end{gathered}
\end{gather}
where
\begin{subequations}
\begin{equation}
\hat T_e = -\dfrac{1}{2} \sum_i \nabla_i^2 
\end{equation}
\begin{equation}
\hat V_{eN} = - \sum_{iI} \dfrac{Z_I}{|\mathbf{R}_I - \mathbf{r}_i|}
\end{equation}
\begin{equation} \label{eq:vnn}
\hat V_{NN} = \sum_{I < J} \dfrac{Z_IZ_J}{|\mathbf{R}_I - \mathbf{R}_J|}
\end{equation}
\begin{equation}
\hat V_{ee} = \sum_{i < j} \dfrac{1}{|\mathbf{r}_i - \mathbf{r}_j|}
\end{equation}
\end{subequations}

The energy of a state is given by the eigenvalues of $\ham$. To greatly simplify the problem, the Born-Oppenheimer approximation\cite{bo} is made, which assumes that the electronic Hamiltonian can be solved at each fixed value of $\mathbf{R}$ to obtain electronic eigenstates parametrically dependent on $\mathbf{R}$.
\begin{equation}\label{eq:elproblem}
\ham_e \ket{\psi(\mathbf{r};\mathbf{R})} = E(\mathbf{R}) \ket{\psi(\mathbf{r};\mathbf{R})}
\end{equation}
where $E$ is the electronic energy and $\ket{\psi}$ are the electronic eigenstates. For focus of this paper will be solving Equation \eqref{eq:elproblem} for $E$ and $\ket{\psi}$.

\subsection{FCI Wavefunction} \label{sec:wf}
Equation \eqref{eq:elproblem} can be solved in theory by expanding $\ket{\psi}$ in a complete basis. This basis will be generated from a single reference determinant obtained from an HF calculation. 

The HF method\cite{hartree,fock,roothaan} minimizes the functional
\begin{equation}
E[\phi_1, \ldots, \phi_n] = \dfrac{\bra{\psi^\prime}\ham_e\ket{\psi^\prime}}{\bra{\psi^\prime}\ket{\psi^\prime}}
\end{equation}
where $n$ is the number of electrons in the system, $\ket{\phi_i}$ are spin orbitals constrained to be orthonormal, and 
\begin{equation} \label{eq:det}
\psi^\prime(\mathbf{r}) = \dfrac{1}{\sqrt{n!}}\det\begin{pmatrix} \phi_1(\mathbf{r}_1) & \cdots & \phi_n(\mathbf{r}_1) \\ \vdots & \ddots & \vdots \\
\phi_1(\mathbf{r}_n) & \cdots & \phi_n(\mathbf{r}_n) \end{pmatrix}
\end{equation}
$\ket{\psi^\prime}$ in this form is referred to as a Slater determinant\cite{slater} and will be denoted more succinctly as
\begin{equation}
\ket{\psi^\prime} = |\phi_1 \cdots \phi_n|
\end{equation}

From the HF method,\cite{roothaan} multiple spin orbitals can be obtained. The $n$ lowest energy spin orbitals are referred to as occupied orbitals. Denote the slater determinant formed by only occupied orbitals as $\ket{\psi_0}$. Higher energy spin orbitals are referred to as virtual orbitals, and put $m$ as the total number of virtual orbitals. Denote $\ket{\psi_{ij\ldots}^{ab\ldots}}$ as the slater determinant formed from the occupied spin orbitals, but replacing occupied spin orbitals $i, j, \ldots$ with virtual spin orbitals $a, b, \ldots$ Note that there are $\binom{n+m}{n}$ possible slater determinants, all orthonormal. The FCI method searches for solutions to Equation $\ref{eq:elproblem}$ within the determinant space spanned by all $\binom{n+m}{n}$ determinants. The $k$\ssth\ solution to Equation $\eqref{eq:elproblem}$ is written as an expansion in this determinant space
\begin{equation}\label{eq:fciwf}
\begin{gathered}
\ket{\psi^{(k)}} = c_0^{;k}\ket{\psi_0} + \sum_{\mathclap{\substack{i\in\text{occ} \\ a \in\text{vir}}}} c_i^{a;k}\ket{\psi_i^a} + \\
\sum_{\mathclap{\substack{i < j; i, j \in\text{occ} \\ a < b; a, b \in\text{vir}}}} c_{ij}^{ab;k}\ket{\psi_{ij}^{ab}} 
+ \cdots
\end{gathered}
\end{equation}
Truncation at the first term gives the HF wavefunction. Truncation at the second term gives the CIS wavefunction. Truncation at the third term gives the CISD wavefunction, and so on. Inclusion of all $\binom{n+m}{n}$ terms gives the FCI wavefunction.

\subsection{Slater-Condon Rules} \label{sec:condonrules}
In order to solve Equation \eqref{eq:elproblem} using Equation \eqref{eq:fciwf}, the Hamiltonian matrix, $\mathcal H$ has to be diagonalized in the space of determinants. The matrix elements of $\mathcal H$ are given by
\begin{equation} \label{eq:hmat}
\mathcal H_{ij} = \bra{\psi_i}\ham_e\ket{\psi_j}
\end{equation}
where $\ket{\psi_i}$ now simply denote different slater determinants within the determinant space.

These matrix elements can be reduced to simpler integrals as summarized by the Slater-Condon rules.\cite{condon} First, $\ham_e$ is expressed as sum of one, two, and zero electron operators.
\begin{equation}
\ham_e = \sum_{i=1}^n \hat h_i + \sum_{i < j}^n \hat g_{ij} + \hat V_{NN}
\end{equation}
where
\begin{subequations}
\begin{equation} \label{eq:h}
\hat h_i = -\dfrac{1}{2} \nabla_i + \sum_I \dfrac{Z_I}{|\mathbf{R}_I - \mathbf{r}_i|}
\end{equation}
\begin{equation} \label{eq:g}
\hat g_{ij} = \dfrac{1}{|\mathbf{r}_i - \mathbf{r}_j|}
\end{equation}
\end{subequations}
and $\hat V_{NN}$ is defined in Equation \eqref{eq:vnn}.

The Slater-Condon rules are now presented. These rules are derived in \ref{app:slatercondon}. Consider two slater determinants $\ket{\psi_1}$ and $\ket{\psi_2}$ with maximum matching orbitals. This means that spin orbitals shared by both determinants are ordered so that they are in the same position within both determinants, with the caveat that each transpose changes the sign of the determinant. In the following equations, $i$ and $j$ indexes shared orbitals. The index on the operators are dropped when the operator acts on a dummy integration variable. The notation $(kl|pq)$ is also defined as
\begin{equation}
(kl|pq) = \int \phi_k^*(\mathbf{r})\phi_p^*(\mathbf{r}^\prime) \frac{1}{|\mathbf{r}-\mathbf{r}^\prime|} \phi_l(\mathbf{r}) \phi_q(\mathbf{r}^\prime) \mathrm{d}\mathbf{r}\mathrm{d}\mathbf{r}^\prime 
\end{equation}
The Slater-Condon rules are:
\begin{enumerate}
\begin{subequations}
\item If $\ket{\psi_1}$ and $\ket{\psi_2}$ are identical, then
\begin{equation} \label{eq:sc0}
\begin{gathered}
\bra{\psi_1} \ham_e \ket{\psi_2} = \sum_{i=1}^n \bra{\phi_i} \hat h \ket{\phi_i} \\ + \sum_{j > i}^n \left[ (jj|ii) - (ji|ji) \right] + V_{NN}
\end{gathered}
\end{equation}

\item If $\ket{\psi_1}$ and $\ket{\psi_2}$ differ by one spin orbital, then
\begin{align*}
\ket{\psi_1} = |\cdots\phi_k\cdots| \\ 
\ket{\psi_2} = |\cdots\phi_p\cdots| 
\end{align*}
\begin{equation} \label{eq:sc1}
\begin{split}
\bra{\psi_1} \ham_e \ket{\psi_2} = & \bra{\phi_k} \hat h \ket{\phi_p} \\ & + \sum_{i=1}^n \left[ (kp|ii) - (ki|ip) \right]
\end{split}
\end{equation}

\item If $\ket{\psi_1}$ and $\ket{\psi_2}$ differ by two spin orbitals, then
\begin{align*}
\ket{\psi_1} = |\cdots\phi_k\phi_l\cdots| \\ 
\ket{\psi_2} = |\cdots\phi_p\phi_q\cdots| 
\end{align*}
\begin{equation} \label{eq:sc2}
\bra{\psi_1} \ham_e \ket{\psi_2} = (kp|lq) - (kq|lp)
\end{equation}

\item If $\ket{\psi_1}$ and $\ket{\psi_2}$ differ by three or more spin orbitals, then
\begin{equation} \label{eq:sc3}
\bra{\psi_1} \ham_e \ket{\psi_2} = 0
\end{equation}
\end{subequations}
\end{enumerate}

It is clear that setting up an FCI calculation requires the evaluation of many integrals. To calculate these integrals, the spin orbitals are approximated by a sum of GTOs,\cite{gto} the number and form of which depending on the type of basis desired. STOs are rarely used because STOs must be numerically integrated, whereas GTOs have analytic integrals.\cite{szabo} The details of the basis used in this study will be discussed in Section \ref{sec:integrals}.

\section{Procedure}

In this study, the FCI Hamiltonian matrix for one geometry of BH and three different geometries of H$_2$O was generated using the Slater-Condon rules presented in Equations \eqref{eq:sc0} to \eqref{eq:sc3}. The value of these integrals were evaluated in the electronic structure package, Q-Chem 4.4.1.\cite{qchem} The Hamiltonian matrices were then diagonalized using the Davidson diagonalization algorithm\cite{davidson,liu} to find the lowest eigenvalue. This algorithm will be discussed in Section \ref{sec:davidson}.

\subsection{Computational Details} \label{sec:integrals}

%Q-Chem was used to compute the integrals in Equations \eqref{eq:sc0} to \eqref{eq:sc3}. These integrals were used to form the FCI Hamiltonian matrix for one geometry of BH and three geometries of H$_2$O. The geometries are listed in Table \ref{tab:geo}
Table \ref{tab:geo} contains a summary of the geometry used in the calculations of each molecule studied.

For BH, the bond length was set to the equilibrium bond length of 1.2449 \AA.\cite{cccbdb} A basis of 6-31G* was used for the calculation of the integrals in Q-Chem. 

For H$_2$O, the HOH angle was set to 110.565$^\circ$ and O---H bond lengths were varied between three different values listed in Table \ref{tab:geo}. To calculate the integrals at each geometry, a DZ quality basis was used. These geometries and the basis match those used in a previous work.\cite{handy-1983}

\begin{table}
\centering
\begin{tabular}{l|c}
\hline\hline
& Bond Length (\AA) \\ \hline
BH & 1.2449 \\ \hline
H$_2$O (1) & 0.9755\\
H$_2$O (2) & 1.4633\\
H$_2$O (3) & 1.9510\\ \hline\hline
\end{tabular}
\caption{The geometries of BH and H$_2$O used in the calculations. Bond length refers to the B---H bond for BH and both O---H bonds for H$_2$O. The HOH bond angle is set at 110.565$^\circ$.}
\label{tab:geo}
\end{table}

\subsection{Davidson Diagonalization} \label{sec:davidson}
The size of the determinant space can be over one million determinants. The cost of diagonalizing the full Hamiltonian matrix in Equation \eqref{eq:hmat} is usually prohibitively large. %In this study, the package Eigen for C++ was utilized to diagonalize the full Hamiltonian.\cite{eigen} Eigen uses a QR iterative algorithm that has a cubic cost and cubic convergence.\cite{qr}

Because of the nature of our problem, a full diagonalization is not necessary. The eigenvalues of Equation \eqref{eq:elproblem} are desired, but typically only the lowest lying eigenvalues are desired. Davidson introduced an iterative eigenvalue algorithm that was capable of converging to a chosen, the lowest for example, eigenvalue in a significantly shorter amount of time.\cite{davidson} Liu later adapted the algorithm to converge to multiple eigenvalues at once.\cite{liu} Liu's formulation is presented in Algorithm \ref{alg:davidson} and this is the formulation that has been implemented in this work.

\begin{algorithm}
 Read in $N \times N$ Hamiltonian matrix, $H$\;
 
 Choose a set of orthonormal trial vectors $B = \{\mathbf{b}^i\}$ with $i = 1,  \ldots, L$ where $L \geq M$\;
 
 $EVFound \leftarrow \varnothing $\;
 
 \While{$|EVFound| < M$}{
  Set $G_{ij} \leftarrow \mathbf{b}^{iT} H \mathbf{b}^j$\;
  Find eigenvalues $\lambda_k$ and eigenvectors $\mathbf{a}_k$ of $G$ and keep the $M$ lowest eigenvalues\;

  \For{k = 1, \ldots, M}
  {
  	$\mathbf{d}^k \leftarrow \sum_i^L a_i^k(A - \lambda^k) \mathbf{b}^i$\;
  	\If{$\mathbf{d}^k \cdot \mathbf{d}^k < 10^{-3}$}
  	{
  		$EVFound = EVFound \cup \{(\lambda^k, \mathbf{a}^k)\}$\;
  	}
  }
  
  \If{$|EVFound| < M$}
  {
  	$EVFound = \varnothing$\;
  }
    
  \For{k = 1, \ldots, M}
  {
  	\For{I = 1, \ldots, N}
  	{
  		$f_I^k = (\lambda^k - H_{II})^{-1}d_I^k$\;
  	}
  	Form residual vector $\mathbf{f}^k = (f_1^k, \ldots, f_N^k)$\;
  }
  
  
  Orthonormalize $\mathbf{f}^1$ with $B$\;
  $B \leftarrow B \cup \{\mathbf{f}^1\}$\;
  $m \leftarrow 1$\;
  
  \For{k = 2, \ldots, M}
  {
  	Orthogonalize $\mathbf{f}^k$ with $B$\;
  	\If{$\mathbf{f}^k \cdot \mathbf{f}^k > 10^{-3}$}
  	{
  		Normalize $\mathbf{f}^k$\;
  		$B \leftarrow B \cup \{\mathbf{f}^k\}$\;
  		$m \leftarrow m + 1$\;
  		
  	}
  }
  Reorthonormalize $B$\;
  $L \leftarrow L + m$\;
 }
 $EVFound$ contains the desired eigenpairs\;

\caption{The Davidson algorithm to find the $M$ lowest eigenvalues of a matrix.} 
\label{alg:davidson}
\end{algorithm}

\section{Results}
\subsection{BH} \label{sec:bhresults}
%Talk about number of electrons and orbitals
The results are compared to a FCI calculation using a 6-31G* basis.\cite{cccbdb}
\begin{table}
\begin{tabular}{l|cc} \hline\hline
& Previous Work\cite{cccbdb} & This Work \\ \hline
Energy ($E_h$) & -25.2023 & -25.2013 \\ \hline\hline
\end{tabular}
\caption{Calculated ground state energies of BH at the geometry specified in Table \ref{tab:geo}.}
\label{tab:bhresults}
\end{table}

\subsection{H$_2$O} \label{sec:h2oresults}
The results are compared to a previous study by Knowles and Handy.\cite{handy-1983} In that study, the same geometry and basis (DZ) was used as was used in this study.

\begin{table}
\begin{tabular}{l|cc} \hline\hline
& Previous Work\cite{handy-1983} & This Work \\ \hline
Geometry 1 & -76.1579 & -76.1581 \\ 
Geometry 2 & -76.0145 & -76.0126 \\
Geometry 3 & -75.9052 & -75.9023 \\\hline\hline
\end{tabular}
\caption{Calculated ground state energies in hartrees of H$_2$O at geometries specified in Table \ref{tab:geo}.}
\end{table}


\section{Conclusions and Outlook}
\label{sect:Concl}
The electronic energies of the ground states of BH and H$_2$O were computed through an FCI analysis. The electronic Hamiltonian for these molecules were diagonalized in a space of all Slater determinants using integrals calculated from Q-Chem.

Although computationally costly, FCI still feasible for a wide range of molecules and is effective in determining the most accurate electronic energies possible for these molecules. The Davidson diagonalization algorithm implemented in this study proved to be an efficient method to obtain the lower eigenvalues of the Hamiltonian. In future studies, a vectorized algorithm will be implemented to circumvent the need to store the Hamiltonian matrix and take advantage of parallelized computer architectures.\cite{handy-1983} It will also be worthwhile to compare the FCI results to results from truncated CI, such as CISD, and to results using CC methods to judge the relative accuracy of other methods.

\section*{Acknowledgements}
Here I acknowledge the assistance of my supervisor, my industrial sponsor,
and the effects of caffeine on my ability to produce this report on time.

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
\appendix

\section{Derivation of the Slater-Condon Rules}
\label{app:slatercondon}
For the derivation, the slater determinant will be written in the form
\begin{equation}
|\phi_1 \ldots \phi_n| = \dfrac{1}{\sqrt{n!}}\sum_{\sigma\in S_n} \text{sign}(\sigma) \phi_{\sigma(1)}(\mathbf{r}_1) \cdots \phi_{\sigma(n)}(\mathbf{r}_n)
\end{equation}
where $S_n$ denotes the permutation group of $n$ elements and sign($\sigma$) is +1 for even permutations, -1 for odd permutations. The proofs are presented below, proved in the same order as presented in Section \ref{sec:condonrules} and using the same notation.

\begin{enumerate}
	\item For the one element operator matrix element, 
	\begin{gather}
	\bra{\psi_1}\sum_i\hat h_i\ket{\psi_1}\\ 
	\begin{gathered}
	= \frac{1}{n!}\sum_{\sigma\sigma^\prime \in S_n} \sum_{i=1}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime)
	 \\ \times \bra{\phi_{\sigma(1)} \cdots \phi_{\sigma(n)}}\hat h_i \ket{\phi_{\sigma^\prime(1)} \cdots \phi_{\sigma^\prime(n)}} 
	\end{gathered} \\
	 \begin{gathered} = \frac{1}{n!}\sum_{\sigma\sigma^\prime \in S_n} \sum_{i=1}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime) \\
	 \times \bra{\phi_{\sigma(i)}} \hat h_i \ket{\phi_{\sigma^\prime(i)}} \prod_{k\neq i}^n \bra{\phi_{\sigma(k)}}\ket{\phi_{\sigma^\prime(k)}}
	 \end{gathered}
	\end{gather}
	Because the spin orbitals are orthonormal, the product is zero when $\sigma \neq \sigma^\prime$ and is unity otherwise.
	\begin{gather}
	= \frac{1}{n!} \sum_{\sigma \in S_n} \text{sign}(\sigma)^2\sum_{i=1}^n \bra{\phi_{\sigma(i)}} \hat h_i \ket{\phi_{\sigma(i)}}
	\end{gather}
	The sign term squares to one always. For any $\sigma$, the second sum will be the same and there are $n!$ possible $\sigma$.
	\begin{gather}
	= \sum_{i=1}^n \bra{\phi_i}\hat h_i \ket{\phi_i}
	\end{gather}
	
	For the two electron operator matrix element,
	\begin{gather}
	\bra{\psi_1}\sum_{i<j}^n\hat g_{ij}\ket{\psi_1} \\
	\begin{gathered}
	= \frac{1}{n!}\sum_{\sigma\sigma^\prime\in S_n} \sum_{i < j}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime) \\
	\times \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma^\prime(i)}\phi_{\sigma^\prime(j)}} \\
	\times \prod_{k \neq i,j}^n \bra{\phi_{\sigma(k)}}\ket{\phi_{\sigma^\prime(k)}}
	\end{gathered}
	\end{gather}
	The third line is zero unless $\sigma$ and $\sigma^\prime$ agree for all $k$ not equal to $i$ or $j$. In this case, $\sigma$ and $\sigma^\prime$ may agree for $i$ and $j$, or switch so that $\sigma(i) = \sigma^\prime(j)$. In the latter case, the relative sign of $\sigma^\prime$ is opposite as well.
	\begin{gather}
	\begin{gathered}
	= \frac{1}{n!} \sum_{\sigma \in S_n} \text{sign}(\sigma) \\ \times \sum_{i < j}^n \left[ \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(i)}\phi_{\sigma(j)}} - \right.\\ \left. \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(j)}\phi_{\sigma(i)}} \right]
	\end{gathered} \\
	\begin{gathered}
	= \frac{n!}{n!} \sum_{i < j}^n \left[ \bra{\phi_i\phi_j}\hat g_{ij} \ket{\phi_i\phi_j} - \right.\\ \left. \bra{\phi_i\phi_j}\hat g_{ij} \ket{\phi_j\phi_i} \right]
	\end{gathered} \\
	= \sum_{i < j}^n \left[ (ii|jj) - (ij|ij) \right]
	\end{gather}
	Finally, the zero electron operator gives
	\begin{equation}
	\bra{\psi_1}\hat V_{NN} \ket{\psi_1} = V_{NN} \bra{\psi_1}\ket{\psi_1} = V_{NN}
	\end{equation}
	
	\item For the one electron operator matrix element,
	\begin{gather}
	\begin{gathered}
	\bra{\psi_1}\sum_{i=1}^n \hat h_i \ket{\psi_2} = \\ \frac{1}{n!} \sum_{\sigma, \sigma^\prime \in S_n}\sum_{i=1}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime) \\
	\times \bra{\cdots\phi_{\sigma(k)}\cdots} \hat h_i \ket{\cdots\phi_{\sigma^\prime(p)}\cdots}
	\end{gathered}
	\end{gather}
	The position of the unique orbital will be denoted $p$, but if $p$ appears in the bra, it implies $k$.
	\begin{gather}
	\begin{gathered}
	\bra{\psi_1}\sum_{i=1}^n \hat h_i \ket{\psi_2} = \\ \frac{1}{n!} \sum_{\sigma, \sigma^\prime \in S_n}\sum_{i=1}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime) \\
	\times \bra{\phi_{\sigma(i)}}\hat h_i \ket{\phi_{\sigma^\prime(i)}} \prod_{j\neq i}^n \bra{\phi_{\sigma(j)}}\ket{\phi_{\sigma^\prime(j)}}
	%\times \bra{\phi_{\sigma(k)}}\ket{\phi_{\sigma^\prime(p)}}
	\end{gathered}
	\end{gather}
	Again, $\sigma$ and $\sigma^\prime$ must agree to be nonzero.
	\begin{gather} \label{eq:hexp}
	\begin{gathered}
	 \frac{1}{n!} \sum_{\sigma \in S_n}\sum_{i=1}^n \text{sign}(\sigma)^2 \\
	\times \bra{\phi_{\sigma(i)}}\hat h_i \ket{\phi_{\sigma(i)}} \prod_{j\neq i}^n \bra{\phi_{\sigma(j)}}\ket{\phi_{\sigma(j)}}
	\end{gathered}
	\end{gather}
	In this case, another possibility is that $\sigma(j) = p$. Since $\phi_p$ is not an orbital in $\ket{\psi_1}$, the term above is zero whenever $\sigma(j) = p$ for all $j \neq i$. This forces $\sigma(i) = p$ and correspondingly, $\sigma(i) = k$ in the bra. The repeated product is then unity. If $i$ is fixed to $k$ or $p$, then there are $(n-1)!$ ways to permute the remaining elements.
	\begin{gather}
	 \frac{1}{n!}(n-1)!\sum_{i=1}^n \bra{\phi_{k}}\hat h_i \ket{\phi_{p}} \\
	 \frac{1}{n!}n(n-1)!\bra{\phi_{k}}\hat h \ket{\phi_{p}} \\
	 \bra{\phi_k}\hat h \ket{\phi_p}
	\end{gather}
	
	For the matrix element of the two electron operator,
	\begin{gather}
	\bra{\psi_1}\frac{1}{2}\sum_{i=1}^n\sum_{j\neq i}^n \hat g_{ij}\ket{\psi_2} \\
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!}\sum_{\sigma\sigma^\prime\in S_n} \sum_{i \neq j}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime) \\
	\times \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma^\prime(i)}\phi_{\sigma^\prime(j)}} \\
	\times \prod_{k \neq i,j}^n \bra{\phi_{\sigma(k)}}\ket{\phi_{\sigma^\prime(k)}}
	\end{gathered}
	\end{gather}
	Again, the third term is zero whenever $\sigma$ and $\sigma^\prime$ disagree on $k \neq i,j$, so among the nonzero permutations are the ones which fix $i$ and $j$, and which switch $i$ and $j$.
	\begin{gather} \label{eq:gexp}
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!} \sum_{\sigma \in S_n} \sum_{i \neq j}^n  \text{sign}(\sigma) \\ \times \left[ \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(i)}\phi_{\sigma(j)}} - \right.\\ \left. \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(j)}\phi_{\sigma(i)}} \right] \\
	\times \prod_{k \neq i,j}^n \bra{\phi_{\sigma(k)}}\ket{\phi_{\sigma^\prime(k)}}
	\end{gathered}
	\end{gather}
	The repeated product over $k$ is zero whenever $\sigma(k) = p$ (or $k$ in $\ket{\psi_1}$) because that orbital is not contained in $\ket{\psi_1}$. Hence, it must be that the only nonzero permutations are ones such that $\sigma(i) = p$ or $\sigma(j) = p$.
	\begin{gather}
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!} \sum_{i \neq j}^n \sum_{\sigma\in S_n} \text{sign}(\sigma) \times \\ \left[ \bra{\phi_{k}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{p}\phi_{\sigma(j)}} - \right.
	\\ \left. \bra{\phi_{k}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(j)}\phi_{p}} \right] \\
	+ \left[ \bra{\phi_{\sigma(i)}\phi_{k}}\hat g_{ij} \ket{\phi_{\sigma(i)}\phi_{p}} - \right.\\ \left. \bra{\phi_{k}\phi_{\sigma(i)}}\hat g_{ij} \ket{\phi_{p}\phi_{\sigma(i)}} \right] 
	\end{gathered}
	\end{gather}
	If $i = j$, then the first and fourth term will cancel out, as well as the second and third term, so we can remove the restriction on the sum. Moreover, the dummy variable of integration can be exchanged on the first and third term to show that these terms are the same, when summed over $i$ and $j$. The same is true for the second and fourth terms.
	\begin{gather}
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!} \sum_{j = 1}^n \sum_{\sigma\in S_n} \text{sign}(\sigma) \times \\ \left[ \bra{\phi_{k}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{p}\phi_{\sigma(j)}} - \right.
	\\ \left. \bra{\phi_{k}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(j)}\phi_{p}} \right] \\
	+ \sum_{i = 1}^n \left[ \bra{\phi_{\sigma(i)}\phi_{k}}\hat g_{ij} \ket{\phi_{\sigma(i)}\phi_{p}} - \right.\\ \left. \bra{\phi_{k}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{p}\phi_{\sigma(i)}} \right] 
	\end{gathered} \\
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!} 2 \sum_{i = 1}^n \sum_{\sigma\in S_n} \text{sign}(\sigma) \times \\ \left[ \bra{\phi_{k}\phi_{\sigma(i)}}\hat g_{ij} \ket{\phi_{p}\phi_{\sigma(i)}} - \right.
	\\ \left. \bra{\phi_{k}\phi_{\sigma(i)}}\hat g_{ij} \ket{\phi_{\sigma(i)}\phi_{p}} \right]
	\end{gathered} \\
	= \frac{2\cdot n!}{2\cdot n!} \sum_{i = 1}^n \left[(kp|ii) - (ki|ip)\right] \\
	= \sum_{i = 1}^n \left[(kp|ii) - (ki|ip)\right]
	\end{gather}
	
	Finally, the matrix element of the zero electron operator is
	\begin{gather}
	\bra{\psi_1} \hat V_{NN} \ket{\psi_2} = V_{NN}\bra{\psi_1}\ket{\psi_2} = 0
	\end{gather}
	
	\item For the one electron operator, the matrix element reduces the same way as was done in previous cases to Equation \eqref{eq:hexp}.
%	\begin{gather}
%	\begin{gathered}
%	\bra{\psi_1}\sum_{i=1}^n \hat h_i \ket{\psi_2} = \\ \frac{1}{n!} \sum_{\sigma, \sigma^\prime \in S_n}\sum_{i=1}^n \text{sign}(\sigma)\text{sign}(\sigma^\prime) \\
%	\times \bra{\cdots\phi_{\sigma(k)}\phi_{\sigma(l)}\cdots} \hat h_i \ket{\cdots\phi_{\sigma^\prime(p)}\phi_{\sigma(q)}\cdots}
%	\end{gathered} \\
%		\begin{gathered}
%	 =\frac{1}{n!} \sum_{\sigma \in S_n}\sum_{i=1}^n \bra{\phi_{\sigma(i)}}\hat h_i \ket{\phi_{\sigma(i)}} \\ \times \prod_{j\neq i}^n \bra{\phi_{\sigma(j)}}\ket{\phi_{\sigma(j)}}
%	\end{gathered}
%	\end{gather}
	In this case, if $\sigma(j)$ is $p$ or $q$, then the product over $j$ will be zero. However, since $j$ loops over all but one element, it must be that $\sigma(j) = p$ or $\sigma(j)=q$ for some $j\neq i$. Thus, for all permutations, this product is zero and
	\begin{equation}
	\bra{\psi_1}\sum_{i=1}^n \hat h_i \ket{\psi_2} = 0
	\end{equation}
	
	The matrix element of the two electron operator reduces the same way as before to Equation \eqref{eq:gexp}.
%	\begin{gather}
%	\begin{gathered}
%	\bra{\psi_1}\frac{1}{2}\sum_{i=1}^n\sum_{j\neq i}^n \hat g_{ij}\ket{\psi_2} = \\ 
%	\frac{1}{2}\frac{1}{n!} \sum_{\sigma \in S_n} \sum_{i \neq j}^n  \text{sign}(\sigma) \\ \times \left[ \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(i)}\phi_{\sigma(j)}} - \right.\\ \left. \bra{\phi_{\sigma(i)}\phi_{\sigma(j)}}\hat g_{ij} \ket{\phi_{\sigma(j)}\phi_{\sigma(i)}} \right] \\
%	\times \prod_{k \neq i,j}^n \bra{\phi_{\sigma(k)}}\ket{\phi_{\sigma^\prime(k)}}
%	\end{gathered}
%	\end{gather}
	Again, $\sigma(k)$ must not be equal to $p$ or $q$ ($k$ or $l$) if the term is to be nonzero. This forces $\sigma(i) = p$ and $\sigma(j) = k$ or the reverse ($k$ and $l$ for $\ket{\psi_1}$).
		\begin{gather}
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!} \sum_{i \neq j}^n \sum_{\sigma\in S_n} \text{sign}(\sigma) \times \\ \left[ \bra{\phi_{k}\phi_{l}}\hat g_{ij} \ket{\phi_{p}\phi_{q}} - \right.
	\\ \left. \bra{\phi_{k}\phi_{l}}\hat g_{ij} \ket{\phi_{q}\phi_{p}} \right] \\
	+ \left[ \bra{\phi_{l}\phi_{k}}\hat g_{ij} \ket{\phi_{q}\phi_{p}} - \right.\\ \left. \bra{\phi_{k}\phi_{l}}\hat g_{ij} \ket{\phi_{p}\phi_{q}} \right] 
	\end{gathered}
	\end{gather}
	The first and third term are equal after switching the dummy variable of integration. Same applies to the second and fourth term. There are $n^2-n = n(n-1)$ terms in the sum over $i \neq j$ and there are $(n-2)!$ permutations of the other $n-2$ elements.
	\begin{gather}
	\begin{gathered}
	= \frac{1}{2}\frac{1}{n!}2 n(n-1)(n-2)! \\ \times \left[ \bra{\phi_{k}\phi_{l}}\hat g_{ij} \ket{\phi_{p}\phi_{q}} - \right.
	\left. \bra{\phi_{k}\phi_{l}}\hat g_{ij} \ket{\phi_{q}\phi_{p}} \right] \\
	\end{gathered}\\
	=(kp|lq) - (kq|lp)
	\end{gather}
	
	And for the zero electron operator.
	\begin{gather}
	\bra{\psi_1} \hat V_{NN} \ket{\psi_2} = V_{NN}\bra{\psi_1}\ket{\psi_2} = 0
	\end{gather}
	
	\item The matrix element of the one electron operator reduces to Equation \eqref{eq:hexp}. Again, if $\sigma(j)$ is $p, q,$ or $r$, the term in the sum is zero. Since the product loops over all but one element, it must be that $\sigma(j)$ takes on one of these values and so the sum totals to zero.
		\begin{equation}
	\bra{\psi_1}\sum_{i=1}^n \hat h_i \ket{\psi_2} = 0
	\end{equation}
	
	The matrix element of the two electron operator reduces to Equation \eqref{eq:gexp}. If $\sigma(k)$ takes on $p$, $q$, or $r$, then the term in the sum is zero. However, since $k$ loops over all but two elements, it must take on at least one of these values in the repeated product. So every term in the sum must be zero.
		\begin{equation}
	\bra{\psi_1}\sum_{j>i}^n \hat g_{ij} \ket{\psi_2} = 0
	\end{equation}
	
	The matrix element of the zero electron operator is
		\begin{gather}
	\bra{\psi_1} \hat V_{NN} \ket{\psi_2} = V_{NN}\bra{\psi_1}\ket{\psi_2} = 0
	\end{gather}
	
\end{enumerate}




%% References
%%
%% Following citation commands can be used in the body text:
%% Usage of \cite is as follows:
%%   \cite{key}         ==>>  [#]
%%   \cite[chap. 2]{key} ==>> [#, chap. 2]
%%

%% References with bibTeX database:

\bibliographystyle{elsarticle-num}
\bibliography{references}

%% Authors are advised to submit their bibtex database files. They are
%% requested to list a bibtex style file in the manuscript if they do
%% not want to use elsarticle-num.bst.

%% References without bibTeX database:

% \begin{thebibliography}{00}

%% \bibitem must have the following form:
%%   \bibitem{key}...
%%

% \bibitem{}

% \end{thebibliography}


\end{document}

%%
%% End of file `elsarticle-template-num.tex'.
